      
# 实验报告：利用辅助函数法计算积分

**学生姓名：** [刘涛] 

**学号：** [20231050159] 

**完成日期：** [2025.06.25]

## 一、实验目的
利用辅助函数法计算积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$，导出由 0 到 1 之间均匀分布随机数产生满足权重函数 $p(x) = {1\over2\sqrt{x}}$ 分布的随机数公式，抽取 $N = 1000000$ 个随机数据点估计积分，并利用公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 估计积分结果的统计误差。

## 二、实验原理
### 2.1 积分计算原理
阐述辅助函数法计算积分的原理，解释目标积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$ 以及权重函数 $p(x) = {1\over2\sqrt{x}}$ 的意义和作用。

### 2.2 随机数生成原理
详细推导由 0 到 1 之间均匀分布随机数产生满足 $p(x)$ 分布的随机数的公式，给出推导过程。

### 2.3 误差估计原理
解释公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 和 ${\rm var}f = \langle f^2\rangle - \langle f\rangle^2$ 的含义和使用方法。

## 三、实验环境
### 3.1 硬件环境
- 计算机型号：[HUAWEI MateBook D 16]
- CPU：[12th Gen Intel(R) Core(TM) i5-12450H 2.00 GHz]
- 内存：[16 GB]

### 3.2 软件环境
- 操作系统：[Windows 11 家庭中文版 24H2]
- 编程语言：[python]
- 开发工具：[IDLE (Python 3.13 64-bit)]

## 四、实验步骤
### 4.1 随机数生成公式实现
给出推导出的随机数生成公式，并编写代码实现该公式，附上关键代码片段。
```python
)
    """
    # 1. 生成服从权重函数p(x) = 1/(2√x)分布的随机数
    # 通过逆变换法，从均匀分布u~U(0,1)转换为x = u^2
    u = np.random.rand(N)
    x_samples = u**2    # 这给出了p(x) = 1/(2√x)的分布
```

### 4.2 积分估计
编写代码抽取 $N = 1000000$ 个随机数据点并估计积分值，附上关键代码片段。
```python
if __name__ == "__main__":
    # 设置采样点数
    N = 1000000
    
    # 执行积分计算
    estimate, error, samples = importance_sampling_integration(N)
    
    # 打印结果
    print(f"积分估计值: {estimate:.8f}")
    print(f"统计误差: ±{error:.8f}")
    print(f"相对误差: {error/estimate*100:.4f}%")
```

### 4.3 误差估计
根据公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 编写代码估计积分结果的统计误差，附上关键代码片段。
```python
# 3. 计算积分估计和方差
    integral_estimate = np.mean(f_over_p)
    var_f = np.var(f_over_p)
    statistical_error = np.sqrt(var_f) / np.sqrt(N)
    
    return integral_estimate, statistical_error, x_samples
```

## 五、实验结果
### 5.1 积分估计结果
记录程序运行得到的积分估计值，并与预期结果 0.84 进行对比。

**积分估计值：** [0.83903605]

### 5.2 误差估计结果
记录程序运行得到的统计误差值。

**统计误差：** [±0.00014085]

## 六、实验结论
总结实验结果，判断是否成功完成实验目的，对实验过程和结果进行评价，并提出改进建议。
答：最后的运行结果为：积分估计值: 0.83903605，统计误差: ±0.00014085，相对误差: 0.0168%

积分估计值与0.84相当接近，可以认为完成实验目的，可以通过增加数据点提高结果的精确度。
        
